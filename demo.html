<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mobile-Friendly Gradient Generator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .color-inputs {
            margin-bottom: 20px;
        }
        .gradient-box {
            height: 200px;
            width: 100%;
            border: 1px solid #000;
            margin-bottom: 15px;
        }
        .remove-btn {
            cursor: pointer;
            background-color: red;
            color: white;
            border: none;
            padding: 2px 6px;
            margin-left: 5px;
        }
        .hex-code {
            width: 100px;
            text-align: center;
        }
        .css-code-box {
            padding: 10px;
            background-color: #f1f1f1;
            border: 1px solid #ddd;
            margin-bottom: 10px;
            position: relative;
        }
        .copy-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            cursor: pointer;
            background-color: #28a745;
            color: white;
            border: none;
            padding: 2px 8px;
        }
        /* Circular degree slider styling for mobile */
        .degree-slider-container {
            position: relative;
            width: 80px;
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin: auto;
        }
        .degree-knob {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: conic-gradient(#ddd, #fff);
            position: relative;
        }
        .degree-knob::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: #000;
        }
        .degree-value {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 1rem;
            font-weight: bold;
        }
        .degree-handle {
            position: absolute;
            width: 10px;
            height: 10px;
            background-color: #000;
            border-radius: 50%;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="container mt-4">
    <div id="color-container" class="color-inputs d-flex align-items-center gap-2 justify-content-between">
        <!-- Color boxes will be added dynamically here -->
    </div>

    <!-- Custom Degree Circular Slider for Mobile -->
    <div class="degree-slider-container mb-3">
        <div class="degree-knob" id="degree-knob">
            <div class="degree-handle" id="degree-handle"></div>
            <div class="degree-value" id="degree-value">90°</div>
        </div>
    </div>

    <button id="add-color-btn" class="btn btn-success mb-3">Add Color</button>

    <div class="gradient-box" id="gradient-box"></div>

    <div class="css-code-box" id="css-code-box">
        <span id="css-code"></span>
        <button class="copy-btn" id="copy-btn">Copy</button>
    </div>
</div>

<script>
    let colorCount = 2; // Starting with 2 colors
    const maxColors = 5; // Maximum 5 colors
    const colorContainer = document.getElementById('color-container');
    const gradientBox = document.getElementById('gradient-box');
    const cssCodeBox = document.getElementById('css-code');
    const copyButton = document.getElementById('copy-btn');

    const degreeKnob = document.getElementById('degree-knob');
    const degreeHandle = document.getElementById('degree-handle');
    const degreeValueDisplay = document.getElementById('degree-value');
    let currentDegree = 90; // Default degree
    const knobRadius = 40; // Half the size of the knob for positioning (smaller radius for mobile)

    // Function to create a color input with hex code display
    function createColorInput(id, value = '#000000') {
        const colorDiv = document.createElement('div');
        colorDiv.classList.add('d-flex', 'flex-column', 'gap-2', 'justify-content-center', 'position-relative');

        const input = document.createElement('input');
        input.type = 'color';
        input.id = `color${id}`;
        input.value = value;
        input.classList.add('mx-auto');
        input.addEventListener('input', () => {
            hexInput.value = input.value; // Update hex code when color changes
            updateGradient();
        });

        // Hex code input
        const hexInput = document.createElement('input');
        hexInput.type = 'text';
        hexInput.classList.add('hex-code', 'mx-auto');
        hexInput.value = value; // Initially set to the color value
        hexInput.readOnly = true;

        // Close button to remove the color input
        const closeBtn = document.createElement('button');
        closeBtn.classList.add('remove-btn', 'position-absolute', 'top-0', 'end-0');
        closeBtn.textContent = 'X';
        closeBtn.addEventListener('click', () => {
            if (colorContainer.children.length > 2) { // Ensure at least 2 colors remain
                colorDiv.remove();
                updateGradient();
            }
        });

        colorDiv.appendChild(input);
        colorDiv.appendChild(hexInput); // Add hex input next to the color picker
        colorDiv.appendChild(closeBtn);

        return colorDiv;
    }

    // Function to update the gradient background and CSS code
    function updateGradient() {
        const colors = [...colorContainer.querySelectorAll('input[type="color"]')].map(input => input.value);
        const degree = currentDegree;
        const cssGradient = `linear-gradient(${degree}deg, ${colors.join(', ')})`;
        gradientBox.style.background = cssGradient;
        cssCodeBox.textContent = `background: ${cssGradient};`;
    }

    // Function to position the degree handle based on the current degree
    function updateHandlePosition(degree) {
        const radian = (degree - 90) * (Math.PI / 180); // Convert to radian and adjust to start from top
        const x = knobRadius + Math.cos(radian) * knobRadius; // x coordinate
        const y = knobRadius + Math.sin(radian) * knobRadius; // y coordinate
        degreeHandle.style.left = `${x - degreeHandle.offsetWidth / 2}px`;
        degreeHandle.style.top = `${y - degreeHandle.offsetHeight / 2}px`;
    }

    // Add initial 2 color inputs
    for (let i = 1; i <= 2; i++) {
        colorContainer.appendChild(createColorInput(i, i === 1 ? '#ff0000' : '#0000ff'));
    }

    // Event listener for adding more colors
    document.getElementById('add-color-btn').addEventListener('click', () => {
        if (colorContainer.children.length < maxColors) {
            const nextId = colorContainer.children.length + 1;
            colorContainer.appendChild(createColorInput(nextId));
        }
    });

    // Copy the generated CSS to clipboard
    copyButton.addEventListener('click', () => {
        const cssCode = cssCodeBox.textContent;
        navigator.clipboard.writeText(cssCode).then(() => {
            alert("CSS code copied!");
        });
    });

    // Degree Knob interaction
    let isDragging = false;
    degreeHandle.addEventListener('mousedown', () => {
        isDragging = true;
    });

    document.addEventListener('mouseup', () => {
        isDragging = false;
    });

    document.addEventListener('mousemove', (event) => {
        if (isDragging) {
            const rect = degreeKnob.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            const deltaX = event.clientX - centerX;
            const deltaY = event.clientY - centerY;
            const angle = Math.atan2(deltaY, deltaX) * (180 / Math.PI);
            currentDegree = (angle + 90 + 360) % 360; // Adjust angle to range [0, 360]
            degreeValueDisplay.textContent = `${Math.round(currentDegree)}°`;
            updateHandlePosition(currentDegree); // Update handle position
            updateGradient();
        }
    });

    // Initialize with the default gradient and handle position
    updateHandlePosition(currentDegree);
    updateGradient();
</script>

</body>
</html>
